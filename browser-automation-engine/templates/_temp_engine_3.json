{
  "name": "Millware Attendance Input - Looping Example - Engine 3",
  "description": "Template untuk input absensi dengan looping data dari JSON",
  "dataFile": "testing_data/_temp_engine_3.json",
  "steps": [
    {
      "action": "navigate",
      "params": {
        "url": "http://millwarep3.rebinmas.com:8003/"
      }
    },
    {
      "action": "typeInput",
      "params": {
        "selector": "#txtUsername",
        "value": "adm075"
      }
    },
    {
      "action": "typeInput",
      "params": {
        "selector": "#txtPassword",
        "value": "adm075"
      }
    },
    {
      "action": "click",
      "params": {
        "selector": "#btnLogin"
      }
    },
    {
      "action": "wait",
      "params": {
        "duration": 1000
      }
    },
    {
      "action": "waitForElement",
      "params": {
        "selector": ".PopupBoxLogin",
        "timeout": 15000
      }
    },
    {
      "action": "click",
      "params": {
        "selector": "#MainContent_btnOkay"
      }
    },
    {
      "action": "navigate",
      "params": {
        "url": "http://millwarep3.rebinmas.com:8003/en/PR/trx/frmPrTrxTaskRegisterDet.aspx"
      }
    },
    {
      "action": "wait",
      "params": {
        "duration": 2000
      }
    },
    {
      "action": "wait",
      "params": {
        "duration": 2000
      }
    },
    {
      "action": "forEach",
      "params": {
        "items": "data.data",
        "itemName": "employee",
        "steps": [
          {
            "action": "log",
            "params": {
              "message": "Processing Employee: ${employee.EmployeeName} (${employee.PTRJEmployeeID})"
            }
          },
          {
            "comment": "‚ïê‚ïê‚ïê PASS 1: Input Data ‚ïê‚ïê‚ïê",
            "action": "include",
            "params": {
              "template": "_attendance_logic"
            }
          },
          {
            "comment": "‚ïê‚ïê‚ïê VALIDATION: Check DB for Mismatches ‚ïê‚ïê‚ïê",
            "action": "verifyEmployeeSync",
            "params": {}
          },
          {
            "comment": "‚ïê‚ïê‚ïê RETRY LOOP: If mismatches found ‚ïê‚ïê‚ïê",
            "action": "if",
            "params": {
              "condition": "context.retryNeeded === true",
              "thenSteps": [
                {
                  "action": "log",
                  "params": {
                    "message": "üîÑ RETRY TRIGGERED: Mismatches detected. Reloading and re-processing..."
                  }
                },
                {
                  "action": "reloadPage",
                  "params": {}
                },
                {
                  "action": "wait",
                  "params": {
                    "duration": 2000
                  }
                },
                {
                  "action": "waitForElement",
                  "params": {
                    "selector": ".ui-autocomplete-input.CBOBox",
                    "timeout": 15000
                  }
                },
                {
                  "comment": "‚ïê‚ïê‚ïê PASS 2: Retry Input ‚ïê‚ïê‚ïê",
                  "action": "include",
                  "params": {
                    "template": "_attendance_logic"
                  }
                },
                {
                  "action": "verifyEmployeeSync",
                  "params": {}
                },
                {
                  "action": "if",
                  "params": {
                    "condition": "context.retryNeeded === true",
                    "thenSteps": [
                      {
                        "action": "log",
                        "params": {
                          "message": "‚ùå Still mismatched after retry. Moving to next employee."
                        }
                      }
                    ],
                    "elseSteps": [
                      {
                        "action": "log",
                        "params": {
                          "message": "‚úÖ Fixed after retry!"
                        }
                      }
                    ]
                  }
                }
              ]
            }
          }
        ]
      }
    },
    {
      "action": "log",
      "params": {
        "message": "‚úÖ Selesai memproses semua data absensi"
      }
    }
  ]
}