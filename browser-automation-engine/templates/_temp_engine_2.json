{
  "name": "Millware Attendance Input - Looping Example - Engine 2",
  "description": "Template untuk input absensi dengan looping data dari JSON",
  "dataFile": "testing_data/_temp_engine_2.json",
  "steps": [
    {
      "action": "navigate",
      "params": {
        "url": "http://millwarep3.rebinmas.com:8003/"
      }
    },
    {
      "action": "typeInput",
      "params": {
        "selector": "#txtUsername",
        "value": "adm075"
      }
    },
    {
      "action": "typeInput",
      "params": {
        "selector": "#txtPassword",
        "value": "adm075"
      }
    },
    {
      "action": "click",
      "params": {
        "selector": "#btnLogin"
      }
    },
    {
      "action": "wait",
      "params": {
        "duration": 1000
      }
    },
    {
      "action": "waitForElement",
      "params": {
        "selector": ".PopupBoxLogin",
        "timeout": 15000
      }
    },
    {
      "action": "click",
      "params": {
        "selector": "#MainContent_btnOkay"
      }
    },
    {
      "action": "navigate",
      "params": {
        "url": "http://millwarep3.rebinmas.com:8003/en/PR/trx/frmPrTrxTaskRegisterDet.aspx"
      }
    },
    {
      "action": "wait",
      "params": {
        "duration": 2000
      }
    },
    {
      "action": "wait",
      "params": {
        "duration": 2000
      }
    },
    {
      "action": "forEach",
      "params": {
        "items": "data.data",
        "itemName": "employee",
        "steps": [
          {
            "action": "log",
            "params": {
              "message": "Processing Employee: ${employee.EmployeeName} (${employee.PTRJEmployeeID})"
            }
          },
          {
            "action": "forEachProperty",
            "params": {
              "object": "employee.Attendance",
              "keyName": "date",
              "valueName": "attendance",
              "steps": [
                {
                  "action": "log",
                  "params": {
                    "message": "  Date: ${date} | Status: ${attendance.status} | Regular: ${attendance.regularHours} | OT: ${attendance.overtimeHours}"
                  }
                },
                {
                  "comment": "Skip ALFA (tidak ada data) dan N/A (data belum tersedia). Annual Leave akan diproses terpisah.",
                  "action": "log",
                  "params": {
                    "message": "  → Checking: status=${attendance.status}, isAnnualLeave=${attendance.isAnnualLeave}"
                  }
                },
                {
                  "comment": "Skip ALFA dan N/A - tidak ada data di database untuk entri ini",
                  "action": "if",
                  "params": {
                    "condition": "attendance.status === 'ALFA' || attendance.status === 'N/A'",
                    "thenSteps": [
                      {
                        "action": "log",
                        "params": {
                          "message": "    ⏭️ SKIP: ${attendance.status} - no data in database"
                        }
                      }
                    ],
                    "elseSteps": [
                      {
                        "comment": "Process ANNUAL LEAVE (CT, Melahirkan, P1, P2, P3) dengan task code GA9130",
                        "action": "if",
                        "params": {
                          "condition": "attendance.isAnnualLeave",
                          "thenSteps": [
                            {
                              "action": "log",
                              "params": {
                                "message": "    → Input ANNUAL LEAVE: ${attendance.status} (${attendance.leaveDescription})"
                              }
                            },
                            {
                              "action": "log",
                              "params": {
                                "message": "    ⏳ Waiting for form to be ready..."
                              }
                            },
                            {
                              "action": "waitForElement",
                              "params": {
                                "selector": ".ui-autocomplete-input.CBOBox",
                                "timeout": 10000,
                                "comment": "Wait for Employee input to appear"
                              }
                            },
                            {
                              "action": "wait",
                              "params": {
                                "duration": 1000,
                                "comment": "Extra wait for form elements to stabilize"
                              }
                            },
                            {
                              "action": "formatDate",
                              "params": {
                                "date": "${attendance.date}",
                                "saveTo": "formattedDateLeave"
                              }
                            },
                            {
                              "action": "typeInput",
                              "params": {
                                "selector": "#MainContent_txtTrxDate",
                                "value": "${formattedDateLeave}"
                              }
                            },
                            {
                              "action": "wait",
                              "params": {
                                "duration": 500
                              }
                            },
                            {
                              "action": "pressKey",
                              "params": {
                                "key": "ArrowDown"
                              }
                            },
                            {
                              "action": "wait",
                              "params": {
                                "duration": 200
                              }
                            },
                            {
                              "action": "pressKey",
                              "params": {
                                "key": "Enter"
                              }
                            },
                            {
                              "action": "wait",
                              "params": {
                                "duration": 500
                              }
                            },
                            {
                              "action": "retryInputWithValidation",
                              "comment": "Input Employee with Validation Retry (Annual Leave)",
                              "params": {
                                "selector": ".ui-autocomplete-input.CBOBox",
                                "index": 0,
                                "value": "${employee.PTRJEmployeeID}",
                                "validationSelector": "#MainContent_ddlEmployee_RFV",
                                "maxRetries": 5,
                                "formReentryFields": []
                              }
                            },
                            {
                              "action": "wait",
                              "params": {
                                "duration": 2000,
                                "comment": "Wait for page reload after employee selection"
                              }
                            },
                            {
                              "comment": "═══ CHECK IF EMPLOYEE INPUT SUCCEEDED ═══",
                              "action": "checkEmployeeInputSuccess",
                              "params": {
                                "validationErrorSelector": "#MainContent_ddlEmployee_RFV",
                                "timeout": 2000
                              }
                            },
                            {
                              "comment": "═══ ONLY CONTINUE IF EMPLOYEE INPUT SUCCEEDED ═══",
                              "action": "if",
                              "params": {
                                "condition": "!context.employeeInputFailed",
                                "thenSteps": [
                                  {
                                    "action": "waitForElement",
                                    "params": {
                                      "selector": "#MainContent_ddlShift",
                                      "timeout": 10000,
                                      "comment": "Wait for Shift dropdown to appear"
                                    }
                                  },
                                  {
                                    "action": "wait",
                                    "params": {
                                      "duration": 500
                                    }
                                  },
                                  {
                                    "action": "retryInputWithValidation",
                                    "comment": "Input Task Code GA9130 PERSONNEL ANNUAL LEAVE",
                                    "params": {
                                      "selector": ".ui-autocomplete-input.CBOBox",
                                      "index": 1,
                                      "value": "(GA9130) PERSONNEL ANNUAL LEAVE",
                                      "validationSelector": "#MainContent_ddlTaskCode_RFV",
                                      "maxRetries": 5,
                                      "formReentryFields": [
                                        {
                                          "selector": ".ui-autocomplete-input.CBOBox",
                                          "index": 0,
                                          "value": "${employee.PTRJEmployeeID}"
                                        }
                                      ]
                                    }
                                  },
                                  {
                                    "action": "wait",
                                    "params": {
                                      "duration": 3000,
                                      "comment": "Wait for page update after Task Code selection"
                                    }
                                  },
                                  {
                                    "action": "typeInput",
                                    "params": {
                                      "selector": "#MainContent_txtHours",
                                      "value": "${attendance.regularHours}"
                                    }
                                  },
                                  {
                                    "action": "pressKey",
                                    "params": {
                                      "key": "Enter"
                                    }
                                  },
                                  {
                                    "comment": "═══ CLICK ADD AND WAIT FOR PAGE RELOAD (ANNUAL LEAVE) ═══",
                                    "action": "clickAndWaitForReload",
                                    "params": {
                                      "selector": "#MainContent_btnAdd",
                                      "timeout": 15000
                                    }
                                  },
                                  {
                                    "comment": "═══ CHECK PAGE AND AUTO-NAVIGATE IF STUCK ON LIST PAGE ═══",
                                    "action": "checkPageAndNavigate",
                                    "params": {}
                                  },
                                  {
                                    "action": "waitForReady",
                                    "params": {
                                      "selector": ".ui-autocomplete-input.CBOBox",
                                      "timeout": 10000
                                    }
                                  },
                                  {
                                    "comment": "═══ VALIDASI: Cek apakah Annual Leave berhasil masuk ═══",
                                    "action": "validateText",
                                    "params": {
                                      "selector": "#MainContent_lblTotalNormalHour",
                                      "minLength": 1,
                                      "throwOnFail": false
                                    }
                                  }
                                ],
                                "elseSteps": [
                                  {
                                    "action": "log",
                                    "params": {
                                      "message": "    ⏭️ SKIP: Employee ${employee.PTRJEmployeeID} (${employee.EmployeeName}) - employee input failed, cannot continue with annual leave entry"
                                    }
                                  }
                                ]
                              }
                            }
                          ],
                          "elseSteps": [
                            {
                              "comment": "Input REGULAR jika hadir (bukan annual leave) DAN bukan mode Only Overtime",
                              "action": "if",
                              "params": {
                                "condition": "attendance.status && !metadata.onlyOvertime",
                                "thenSteps": [
                                  {
                                    "action": "log",
                                    "params": {
                                      "message": "    → Input REGULAR (status: ${attendance.status})"
                                    }
                                  },
                                  {
                                    "action": "log",
                                    "params": {
                                      "message": "    ⏳ Waiting for form to be ready..."
                                    }
                                  },
                                  {
                                    "action": "waitForElement",
                                    "params": {
                                      "selector": ".ui-autocomplete-input.CBOBox",
                                      "timeout": 10000,
                                      "comment": "Wait for Employee input to appear"
                                    }
                                  },
                                  {
                                    "action": "wait",
                                    "params": {
                                      "duration": 1000,
                                      "comment": "Extra wait for form elements to stabilize"
                                    }
                                  },
                                  {
                                    "action": "formatDate",
                                    "params": {
                                      "date": "${attendance.date}",
                                      "saveTo": "formattedDate"
                                    }
                                  },
                                  {
                                    "action": "typeInput",
                                    "params": {
                                      "selector": "#MainContent_txtTrxDate",
                                      "value": "${formattedDate}"
                                    }
                                  },
                                  {
                                    "action": "wait",
                                    "params": {
                                      "duration": 500,
                                      "comment": "Wait for autocomplete dropdown"
                                    }
                                  },
                                  {
                                    "action": "pressKey",
                                    "params": {
                                      "key": "ArrowDown",
                                      "comment": "Select first autocomplete result"
                                    }
                                  },
                                  {
                                    "action": "wait",
                                    "params": {
                                      "duration": 200
                                    }
                                  },
                                  {
                                    "action": "pressKey",
                                    "params": {
                                      "key": "Enter",
                                      "comment": "Confirm autocomplete selection"
                                    }
                                  },
                                  {
                                    "action": "wait",
                                    "params": {
                                      "duration": 500
                                    }
                                  },
                                  {
                                    "action": "retryInputWithValidation",
                                    "comment": "Input Employee with Validation Retry - ensures employee is properly selected",
                                    "params": {
                                      "selector": ".ui-autocomplete-input.CBOBox",
                                      "index": 0,
                                      "value": "${employee.PTRJEmployeeID}",
                                      "validationSelector": "#MainContent_ddlEmployee_RFV",
                                      "maxRetries": 5,
                                      "formReentryFields": []
                                    }
                                  },
                                  {
                                    "action": "wait",
                                    "params": {
                                      "duration": 2000,
                                      "comment": "Wait for page reload after employee selection"
                                    }
                                  },
                                  {
                                    "comment": "═══ CHECK IF EMPLOYEE INPUT SUCCEEDED ═══",
                                    "action": "checkEmployeeInputSuccess",
                                    "params": {
                                      "validationErrorSelector": "#MainContent_ddlEmployee_RFV",
                                      "timeout": 2000
                                    }
                                  },
                                  {
                                    "comment": "═══ ONLY CONTINUE IF EMPLOYEE INPUT SUCCEEDED ═══",
                                    "action": "if",
                                    "params": {
                                      "condition": "!context.employeeInputFailed",
                                      "thenSteps": [
                                        {
                                          "action": "waitForElement",
                                          "params": {
                                            "selector": "#MainContent_ddlShift",
                                            "timeout": 10000,
                                            "comment": "Wait for Shift dropdown to appear"
                                          }
                                        },
                                        {
                                          "action": "wait",
                                          "params": {
                                            "duration": 500
                                          }
                                        },
                                        {
                                          "action": "checkElementState",
                                          "params": {
                                            "selector": ".ui-autocomplete-input.CBOBox",
                                            "index": 1,
                                            "saveTo": "taskCodeState"
                                          }
                                        },
                                        {
                                          "comment": "SKIP Logic: If Task Code is disabled, data already exists",
                                          "action": "if",
                                          "params": {
                                            "condition": "!taskCodeState.disabled",
                                            "thenSteps": [
                                              {
                                                "action": "parseChargeJob",
                                                "params": {
                                                  "chargeJob": "${employee.ChargeJob}"
                                                }
                                              },
                                              {
                                                "action": "retryInputWithValidation",
                                                "comment": "Input Task Code with Validation Retry - re-enters Employee if validation fails",
                                                "params": {
                                                  "selector": ".ui-autocomplete-input.CBOBox",
                                                  "index": 1,
                                                  "value": "${chargeJobPart1Clean}",
                                                  "validationSelector": "#MainContent_ddlTaskCode_RFV",
                                                  "maxRetries": 5,
                                                  "formReentryFields": [
                                                    {
                                                      "selector": ".ui-autocomplete-input.CBOBox",
                                                      "index": 0,
                                                      "value": "${employee.PTRJEmployeeID}"
                                                    }
                                                  ]
                                                }
                                              },
                                              {
                                                "action": "wait",
                                                "params": {
                                                  "duration": 3000,
                                                  "comment": "Wait for page update after Task Code selection"
                                                }
                                              },
                                              {
                                                "comment": "═══ CONDITIONAL: Input Part 2 only if exists ═══",
                                                "action": "if",
                                                "params": {
                                                  "condition": "hasChargeJobPart2",
                                                  "thenSteps": [
                                                    {
                                                      "action": "retryInputWithValidation",
                                                      "comment": "Input Part 2 with Validation Retry",
                                                      "params": {
                                                        "selector": ".ui-autocomplete-input.CBOBox",
                                                        "index": 2,
                                                        "value": "${chargeJobPart2}",
                                                        "validationSelector": "#MainContent_ddlAccountCode_RFV",
                                                        "maxRetries": 5,
                                                        "expectedFieldCount": "${expectedFieldCount}",
                                                        "formReentryFields": [
                                                          {
                                                            "selector": ".ui-autocomplete-input.CBOBox",
                                                            "index": 0,
                                                            "value": "${employee.PTRJEmployeeID}"
                                                          },
                                                          {
                                                            "selector": ".ui-autocomplete-input.CBOBox",
                                                            "index": 1,
                                                            "value": "${chargeJobPart1Clean}"
                                                          }
                                                        ]
                                                      }
                                                    }
                                                  ]
                                                }
                                              },
                                              {
                                                "comment": "═══ CONDITIONAL: Input Part 3 only if exists ═══",
                                                "action": "if",
                                                "params": {
                                                  "condition": "hasChargeJobPart3",
                                                  "thenSteps": [
                                                    {
                                                      "action": "retryInputWithValidation",
                                                      "comment": "Input Part 3 with Validation Retry",
                                                      "params": {
                                                        "selector": ".ui-autocomplete-input.CBOBox",
                                                        "index": 3,
                                                        "value": "${chargeJobPart3}",
                                                        "validationSelector": "#MainContent_ddlSubBlock_RFV",
                                                        "maxRetries": 5,
                                                        "expectedFieldCount": "${expectedFieldCount}",
                                                        "formReentryFields": [
                                                          {
                                                            "selector": ".ui-autocomplete-input.CBOBox",
                                                            "index": 0,
                                                            "value": "${employee.PTRJEmployeeID}"
                                                          },
                                                          {
                                                            "selector": ".ui-autocomplete-input.CBOBox",
                                                            "index": 1,
                                                            "value": "${chargeJobPart1Clean}"
                                                          },
                                                          {
                                                            "selector": ".ui-autocomplete-input.CBOBox",
                                                            "index": 2,
                                                            "value": "${chargeJobPart2}"
                                                          }
                                                        ]
                                                      }
                                                    }
                                                  ]
                                                }
                                              },
                                              {
                                                "action": "log",
                                                "params": {
                                                  "message": "  Skipping Hour Input for Regular/Normal transaction as requested."
                                                }
                                              },
                                              {
                                                "action": "pressKey",
                                                "params": {
                                                  "key": "Enter"
                                                }
                                              },
                                              {
                                                "comment": "═══ CLICK ADD AND WAIT FOR PAGE RELOAD ═══",
                                                "action": "clickAndWaitForReload",
                                                "params": {
                                                  "selector": "#MainContent_btnAdd",
                                                  "timeout": 15000
                                                }
                                              },
                                              {
                                                "comment": "═══ CHECK PAGE AND AUTO-NAVIGATE IF STUCK ON LIST PAGE ═══",
                                                "action": "checkPageAndNavigate",
                                                "params": {}
                                              },
                                              {
                                                "action": "waitForReady",
                                                "params": {
                                                  "selector": ".ui-autocomplete-input.CBOBox",
                                                  "timeout": 10000
                                                }
                                              },
                                              {
                                                "comment": "═══ VALIDASI: Cek apakah data berhasil masuk ═══",
                                                "action": "validateText",
                                                "params": {
                                                  "selector": "#MainContent_lblTotalNormalHour",
                                                  "minLength": 1,
                                                  "throwOnFail": false
                                                }
                                              }
                                            ],
                                            "elseSteps": [
                                              {
                                                "action": "log",
                                                "params": {
                                                  "message": "  ⚠️ SKIPPING: Transaction Type is DISABLED (Data already exists). Refreshing..."
                                                }
                                              },
                                              {
                                                "action": "navigate",
                                                "params": {
                                                  "url": "http://millwarep3.rebinmas.com:8003/en/PR/trx/frmPrTrxTaskRegisterDet.aspx"
                                                }
                                              },
                                              {
                                                "action": "wait",
                                                "params": {
                                                  "duration": 2000
                                                }
                                              }
                                            ]
                                          }
                                        }
                                      ],
                                      "elseSteps": [
                                        {
                                          "action": "log",
                                          "params": {
                                            "message": "    ⏭️ SKIP: Employee ${employee.PTRJEmployeeID} (${employee.EmployeeName}) - employee input failed, cannot continue with regular hours entry"
                                          }
                                        }
                                      ]
                                    }
                                  }
                                ],
                                "elseSteps": [
                                  {
                                    "comment": "Mode: OVERTIME ONLY - Check if this date has overtime hours before processing",
                                    "action": "if",
                                    "params": {
                                      "condition": "attendance.overtimeHours && attendance.overtimeHours > 0",
                                      "thenSteps": [
                                        {
                                          "action": "log",
                                          "params": {
                                            "message": "    → Processing OVERTIME ONLY: ${attendance.overtimeHours}h"
                                          }
                                        },
                                        {
                                          "action": "formatDate",
                                          "params": {
                                            "date": "${attendance.date}",
                                            "saveTo": "formattedDateOT"
                                          }
                                        },
                                        {
                                          "action": "typeInput",
                                          "params": {
                                            "selector": "#MainContent_txtTrxDate",
                                            "value": "${formattedDateOT}"
                                          }
                                        },
                                        {
                                          "action": "wait",
                                          "params": {
                                            "duration": 500,
                                            "comment": "Wait for autocomplete dropdown"
                                          }
                                        },
                                        {
                                          "action": "pressKey",
                                          "params": {
                                            "key": "Enter",
                                            "comment": "Confirm autocomplete selection"
                                          }
                                        },
                                        {
                                          "action": "wait",
                                          "params": {
                                            "duration": 5000,
                                            "comment": "Wait for ASP.NET date postback to complete"
                                          }
                                        },
                                        {
                                          "action": "retryInputWithValidation",
                                          "comment": "Input Employee with Validation Retry - ensures employee is properly selected (Overtime Mode)",
                                          "params": {
                                            "selector": ".ui-autocomplete-input.CBOBox",
                                            "index": 0,
                                            "value": "${employee.PTRJEmployeeID}",
                                            "validationSelector": "#MainContent_ddlEmployee_RFV",
                                            "maxRetries": 5,
                                            "formReentryFields": []
                                          }
                                        },
                                        {
                                          "action": "wait",
                                          "params": {
                                            "duration": 2000,
                                            "comment": "Wait for page reload after employee selection"
                                          }
                                        },
                                        {
                                          "comment": "═══ CHECK IF EMPLOYEE INPUT SUCCEEDED ═══",
                                          "action": "checkEmployeeInputSuccess",
                                          "params": {
                                            "validationErrorSelector": "#MainContent_ddlEmployee_RFV",
                                            "timeout": 2000
                                          }
                                        },
                                        {
                                          "comment": "═══ ONLY CONTINUE IF EMPLOYEE INPUT SUCCEEDED ═══",
                                          "action": "if",
                                          "params": {
                                            "condition": "!context.employeeInputFailed",
                                            "thenSteps": [
                                              {
                                                "action": "waitForElement",
                                                "params": {
                                                  "selector": "#MainContent_ddlShift",
                                                  "timeout": 10000,
                                                  "comment": "Wait for Shift dropdown to appear"
                                                }
                                              },
                                              {
                                                "action": "wait",
                                                "params": {
                                                  "duration": 500
                                                }
                                              },
                                              {
                                                "action": "click",
                                                "params": {
                                                  "selector": "#MainContent_rblOT_1",
                                                  "comment": "Select Overtime radio button"
                                                }
                                              },
                                              {
                                                "action": "wait",
                                                "params": {
                                                  "duration": 5000,
                                                  "comment": "Wait for overtime radio postback"
                                                }
                                              },
                                              {
                                                "action": "waitForReady",
                                                "params": {
                                                  "selector": ".ui-autocomplete-input.CBOBox",
                                                  "timeout": 15000
                                                }
                                              },
                                              {
                                                "action": "parseChargeJob",
                                                "params": {
                                                  "chargeJob": "${employee.ChargeJob}"
                                                }
                                              },
                                              {
                                                "action": "retryInputWithValidation",
                                                "comment": "Input Task Code with Validation Retry - re-enters Employee if validation fails",
                                                "params": {
                                                  "selector": ".ui-autocomplete-input.CBOBox",
                                                  "index": 1,
                                                  "value": "${chargeJobPart1Clean}",
                                                  "validationSelector": "#MainContent_ddlTaskCode_RFV",
                                                  "maxRetries": 5,
                                                  "formReentryFields": [
                                                    {
                                                      "selector": ".ui-autocomplete-input.CBOBox",
                                                      "index": 0,
                                                      "value": "${employee.PTRJEmployeeID}"
                                                    }
                                                  ]
                                                }
                                              },
                                              {
                                                "action": "wait",
                                                "params": {
                                                  "duration": 3000,
                                                  "comment": "Wait for page update after Task Code selection"
                                                }
                                              },
                                              {
                                                "action": "retryInputWithValidation",
                                                "comment": "Input Part 2 with Validation Retry - re-enters Employee and Task Code if validation fails",
                                                "params": {
                                                  "selector": ".ui-autocomplete-input.CBOBox",
                                                  "index": 2,
                                                  "value": "${chargeJobPart2}",
                                                  "validationSelector": "#MainContent_ddlAccountCode_RFV",
                                                  "maxRetries": 5,
                                                  "formReentryFields": [
                                                    {
                                                      "selector": ".ui-autocomplete-input.CBOBox",
                                                      "index": 0,
                                                      "value": "${employee.PTRJEmployeeID}"
                                                    },
                                                    {
                                                      "selector": ".ui-autocomplete-input.CBOBox",
                                                      "index": 1,
                                                      "value": "${chargeJobPart1Clean}"
                                                    }
                                                  ]
                                                }
                                              },
                                              {
                                                "action": "retryInputWithValidation",
                                                "comment": "Input Part 3 with Validation Retry - re-enters previous fields if validation fails",
                                                "params": {
                                                  "selector": ".ui-autocomplete-input.CBOBox",
                                                  "index": 3,
                                                  "value": "${chargeJobPart3}",
                                                  "validationSelector": "#MainContent_ddlSubBlock_RFV",
                                                  "maxRetries": 5,
                                                  "expectedFieldCount": "${expectedFieldCount}",
                                                  "formReentryFields": [
                                                    {
                                                      "selector": ".ui-autocomplete-input.CBOBox",
                                                      "index": 0,
                                                      "value": "${employee.PTRJEmployeeID}"
                                                    },
                                                    {
                                                      "selector": ".ui-autocomplete-input.CBOBox",
                                                      "index": 1,
                                                      "value": "${chargeJobPart1Clean}"
                                                    },
                                                    {
                                                      "selector": ".ui-autocomplete-input.CBOBox",
                                                      "index": 2,
                                                      "value": "${chargeJobPart2}"
                                                    }
                                                  ]
                                                }
                                              },
                                              {
                                                "action": "if",
                                                "params": {
                                                  "condition": "true",
                                                  "thenSteps": [
                                                    {
                                                      "action": "click",
                                                      "params": {
                                                        "selector": "#MainContent_rblOT_1",
                                                        "comment": "Force re-click Overtime radio to ensure it is selected before typing hours"
                                                      }
                                                    },
                                                    {
                                                      "action": "wait",
                                                      "params": {
                                                        "duration": 3000,
                                                        "comment": "Wait for postback after force-click"
                                                      }
                                                    }
                                                  ]
                                                }
                                              },
                                              {
                                                "action": "typeInput",
                                                "params": {
                                                  "selector": "#MainContent_txtHours",
                                                  "value": "${attendance.overtimeHours}"
                                                }
                                              },
                                              {
                                                "action": "pressKey",
                                                "params": {
                                                  "key": "Enter"
                                                }
                                              },
                                              {
                                                "comment": "═══ CLICK ADD AND WAIT FOR PAGE RELOAD (OVERTIME) ═══",
                                                "action": "clickAndWaitForReload",
                                                "params": {
                                                  "selector": "#MainContent_btnAdd",
                                                  "timeout": 15000
                                                }
                                              },
                                              {
                                                "comment": "═══ CHECK PAGE AND AUTO-NAVIGATE IF STUCK ON LIST PAGE ═══",
                                                "action": "checkPageAndNavigate",
                                                "params": {}
                                              },
                                              {
                                                "action": "waitForReady",
                                                "params": {
                                                  "selector": ".ui-autocomplete-input.CBOBox",
                                                  "timeout": 10000
                                                }
                                              }
                                            ]
                                          }
                                        }
                                      ],
                                      "elseSteps": [
                                        {
                                          "action": "log",
                                          "params": {
                                            "message": "    ⏭️ SKIP: Employee ${employee.PTRJEmployeeID} (${employee.EmployeeName}) - employee input failed, cannot continue with overtime entry"
                                          }
                                        }
                                      ]
                                    }
                                  }
                                ]
                              }
                            },
                            {
                              "comment": "Input OVERTIME jika ada (overtimeHours > 0)",
                              "action": "if",
                              "params": {
                                "condition": "attendance.overtimeHours && !metadata.onlyOvertime",
                                "thenSteps": [
                                  {
                                    "action": "log",
                                    "params": {
                                      "message": "    → Input OVERTIME hours: ${attendance.overtimeHours}"
                                    }
                                  },
                                  {
                                    "action": "formatDate",
                                    "params": {
                                      "date": "${attendance.date}",
                                      "saveTo": "formattedDateOT"
                                    }
                                  },
                                  {
                                    "action": "typeInput",
                                    "params": {
                                      "selector": "#MainContent_txtTrxDate",
                                      "value": "${formattedDateOT}"
                                    }
                                  },
                                  {
                                    "action": "wait",
                                    "params": {
                                      "duration": 500,
                                      "comment": "Wait for autocomplete dropdown"
                                    }
                                  },
                                  {
                                    "action": "wait",
                                    "params": {
                                      "duration": 200
                                    }
                                  },
                                  {
                                    "action": "pressKey",
                                    "params": {
                                      "key": "Enter",
                                      "comment": "Confirm autocomplete selection"
                                    }
                                  },
                                  {
                                    "action": "wait",
                                    "params": {
                                      "duration": 500
                                    }
                                  },
                                  {
                                    "action": "retryInputWithValidation",
                                    "comment": "Input Employee with Validation Retry - ensures employee is properly selected (Overtime)",
                                    "params": {
                                      "selector": ".ui-autocomplete-input.CBOBox",
                                      "index": 0,
                                      "value": "${employee.PTRJEmployeeID}",
                                      "validationSelector": "#MainContent_ddlEmployee_RFV",
                                      "maxRetries": 5,
                                      "formReentryFields": []
                                    }
                                  },
                                  {
                                    "action": "wait",
                                    "params": {
                                      "duration": 2000,
                                      "comment": "Wait for page reload after employee selection"
                                    }
                                  },
                                  {
                                    "comment": "═══ CHECK IF EMPLOYEE INPUT SUCCEEDED ═══",
                                    "action": "checkEmployeeInputSuccess",
                                    "params": {
                                      "validationErrorSelector": "#MainContent_ddlEmployee_RFV",
                                      "timeout": 2000
                                    }
                                  },
                                  {
                                    "comment": "═══ ONLY CONTINUE IF EMPLOYEE INPUT SUCCEEDED ═══",
                                    "action": "if",
                                    "params": {
                                      "condition": "!context.employeeInputFailed",
                                      "thenSteps": [
                                        {
                                          "action": "waitForElement",
                                          "params": {
                                            "selector": "#MainContent_ddlShift",
                                            "timeout": 10000,
                                            "comment": "Wait for Shift dropdown to appear"
                                          }
                                        },
                                        {
                                          "action": "wait",
                                          "params": {
                                            "duration": 500
                                          }
                                        },
                                        {
                                          "action": "click",
                                          "params": {
                                            "selector": "#MainContent_rblOT_1",
                                            "comment": "Pilih Overtime"
                                          }
                                        },
                                        {
                                          "action": "wait",
                                          "params": {
                                            "duration": 3000,
                                            "comment": "Wait for overtime radio postback"
                                          }
                                        },
                                        {
                                          "action": "waitForReady",
                                          "params": {
                                            "selector": ".ui-autocomplete-input.CBOBox",
                                            "timeout": 15000
                                          }
                                        },
                                        {
                                          "action": "parseChargeJob",
                                          "params": {
                                            "chargeJob": "${employee.ChargeJob}"
                                          }
                                        },
                                        {
                                          "action": "retryInputWithValidation",
                                          "comment": "Input Task Code with Validation Retry (Overtime)",
                                          "params": {
                                            "selector": ".ui-autocomplete-input.CBOBox",
                                            "index": 1,
                                            "value": "${chargeJobPart1Clean}",
                                            "validationSelector": "#MainContent_ddlTaskCode_RFV",
                                            "maxRetries": 5,
                                            "formReentryFields": [
                                              {
                                                "selector": ".ui-autocomplete-input.CBOBox",
                                                "index": 0,
                                                "value": "${employee.PTRJEmployeeID}"
                                              }
                                            ]
                                          }
                                        },
                                        {
                                          "action": "wait",
                                          "params": {
                                            "duration": 1000,
                                            "comment": "Wait for autocomplete/next field"
                                          }
                                        },
                                        {
                                          "action": "pressKey",
                                          "params": {
                                            "key": "Enter"
                                          }
                                        },
                                        {
                                          "action": "wait",
                                          "params": {
                                            "duration": 3000,
                                            "comment": "Wait for ASP.NET postback to load Equipment dropdown"
                                          }
                                        },
                                        {
                                          "action": "waitForElement",
                                          "params": {
                                            "selector": ".ui-autocomplete-input.CBOBox",
                                            "timeout": 15000,
                                            "comment": "Wait for Equipment dropdown to appear after postback"
                                          }
                                        },
                                        {
                                          "comment": "═══ CONDITIONAL: Input Part 2 only if exists (Overtime) ═══",
                                          "action": "if",
                                          "params": {
                                            "condition": "hasChargeJobPart2",
                                            "thenSteps": [
                                              {
                                                "action": "retryInputWithValidation",
                                                "comment": "Input Part 2 with Validation Retry (Overtime)",
                                                "params": {
                                                  "selector": ".ui-autocomplete-input.CBOBox",
                                                  "index": 2,
                                                  "value": "${chargeJobPart2}",
                                                  "validationSelector": "#MainContent_ddlAccountCode_RFV",
                                                  "maxRetries": 5,
                                                  "expectedFieldCount": "${expectedFieldCount}",
                                                  "formReentryFields": [
                                                    {
                                                      "selector": ".ui-autocomplete-input.CBOBox",
                                                      "index": 0,
                                                      "value": "${employee.PTRJEmployeeID}"
                                                    },
                                                    {
                                                      "selector": ".ui-autocomplete-input.CBOBox",
                                                      "index": 1,
                                                      "value": "${chargeJobPart1Clean}"
                                                    }
                                                  ]
                                                }
                                              },
                                              {
                                                "action": "wait",
                                                "params": {
                                                  "duration": 1000
                                                }
                                              },
                                              {
                                                "action": "pressKey",
                                                "params": {
                                                  "key": "Enter"
                                                }
                                              }
                                            ]
                                          }
                                        },
                                        {
                                          "comment": "═══ CONDITIONAL: Input Part 3 only if exists (Overtime) ═══",
                                          "action": "if",
                                          "params": {
                                            "condition": "hasChargeJobPart3",
                                            "thenSteps": [
                                              {
                                                "action": "retryInputWithValidation",
                                                "comment": "Input Part 3 with Validation Retry (Overtime)",
                                                "params": {
                                                  "selector": ".ui-autocomplete-input.CBOBox",
                                                  "index": 3,
                                                  "value": "${chargeJobPart3}",
                                                  "validationSelector": "#MainContent_ddlSubBlock_RFV",
                                                  "maxRetries": 5,
                                                  "expectedFieldCount": "${expectedFieldCount}",
                                                  "formReentryFields": [
                                                    {
                                                      "selector": ".ui-autocomplete-input.CBOBox",
                                                      "index": 0,
                                                      "value": "${employee.PTRJEmployeeID}"
                                                    },
                                                    {
                                                      "selector": ".ui-autocomplete-input.CBOBox",
                                                      "index": 1,
                                                      "value": "${chargeJobPart1Clean}"
                                                    },
                                                    {
                                                      "selector": ".ui-autocomplete-input.CBOBox",
                                                      "index": 2,
                                                      "value": "${chargeJobPart2}"
                                                    }
                                                  ]
                                                }
                                              },
                                              {
                                                "action": "wait",
                                                "params": {
                                                  "duration": 1000
                                                }
                                              },
                                              {
                                                "action": "pressKey",
                                                "params": {
                                                  "key": "Enter"
                                                }
                                              }
                                            ]
                                          }
                                        },
                                        {
                                          "action": "typeInput",
                                          "params": {
                                            "selector": "#MainContent_txtHours",
                                            "value": "${attendance.overtimeHours}"
                                          }
                                        },
                                        {
                                          "action": "pressKey",
                                          "params": {
                                            "key": "Enter"
                                          }
                                        },
                                        {
                                          "comment": "═══ CLICK ADD AND WAIT FOR PAGE RELOAD (OVERTIME) ═══",
                                          "action": "clickAndWaitForReload",
                                          "params": {
                                            "selector": "#MainContent_btnAdd",
                                            "timeout": 15000
                                          }
                                        },
                                        {
                                          "comment": "═══ CHECK PAGE AND AUTO-NAVIGATE IF STUCK ON LIST PAGE ═══",
                                          "action": "checkPageAndNavigate",
                                          "params": {}
                                        },
                                        {
                                          "action": "waitForReady",
                                          "params": {
                                            "selector": ".ui-autocomplete-input.CBOBox",
                                            "timeout": 10000
                                          }
                                        },
                                        {
                                          "comment": "═══ VALIDASI: Cek apakah OT berhasil masuk ═══",
                                          "action": "validateText",
                                          "params": {
                                            "selector": "#MainContent_lblTotalOTHour",
                                            "minLength": 1,
                                            "throwOnFail": false
                                          }
                                        }
                                      ],
                                      "elseSteps": [
                                        {
                                          "action": "log",
                                          "params": {
                                            "message": "    ⏭️ SKIP: Employee ${employee.PTRJEmployeeID} (${employee.EmployeeName}) - employee input failed, cannot continue with overtime entry"
                                          }
                                        }
                                      ]
                                    }
                                  }
                                ]
                              }
                            }
                          ]
                        }
                      }
                    ]
                  }
                }
              ]
            }
          }
        ]
      }
    },
    {
      "action": "log",
      "params": {
        "message": "✅ Selesai memproses semua data absensi"
      }
    }
  ]
}